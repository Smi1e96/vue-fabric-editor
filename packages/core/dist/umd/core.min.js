!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(self,(function(){return function(){var t={843:function(t,e,n){"use strict";var r,o=n(334).default,i="object"===("undefined"==typeof Reflect?"undefined":o(Reflect))?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function c(){c.init.call(this)}t.exports=c,t.exports.once=function(t,e){return new Promise((function(n,r){function o(n){t.removeListener(e,i),r(n)}function i(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}g(t,e,i,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&g(t,"error",e,n)}(t,o,{once:!0})}))},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var u=10;function l(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+o(t))}function f(t){return void 0===t._maxListeners?c.defaultMaxListeners:t._maxListeners}function p(t,e,n,r){var o,i,s,a;if(l(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=f(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function v(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):m(o,o.length)}function y(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function g(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+o(t));t.addEventListener(e,(function o(i){r.once&&t.removeEventListener(e,o),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");u=t}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(e.length>0&&(i=e[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)s(c,this,e);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)s(l[n],this,e)}return!0},c.prototype.addListener=function(t,e){return p(this,t,e,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(t,e){return p(this,t,e,!0)},c.prototype.once=function(t,e){return l(e),this.on(t,d(this,t,e)),this},c.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,d(this,t,e)),this},c.prototype.removeListener=function(t,e){var n,r,o,i,s;if(l(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},c.prototype.listeners=function(t){return v(this,t,!0)},c.prototype.rawListeners=function(t){return v(this,t,!1)},c.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):y.call(t,e)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},302:function(t,e,n){t=n.nmd(t);var r=n(334).default;!function(){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function n(t){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(t)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function o(t,e){t.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+e+";"}function i(t){var e=t.g.offsetWidth,n=e+100;return t.j.style.width=n+"px",t.i.scrollLeft=n,t.h.scrollLeft=t.h.scrollWidth+100,t.l!==e&&(t.l=e,!0)}function s(t,n){function r(){var t=o;i(t)&&null!==t.g.parentNode&&n(t.l)}var o=t;e(t.h,r),e(t.i,r),i(t)}function a(t,e,n){e=e||{},n=n||window,this.family=t,this.style=e.style||"normal",this.weight=e.weight||"normal",this.stretch=e.stretch||"normal",this.context=n}var c=null,u=null,l=null,f=null;function p(t){return null===f&&(f=!!t.document.fonts),f}function h(t,e){var n=t.style,r=t.weight;if(null===l){var o=document.createElement("div");try{o.style.font="condensed 100px sans-serif"}catch(t){}l=""!==o.style.font}return[n,r,l?t.stretch:"","100px",e].join(" ")}a.prototype.load=function(t,e){var r=this,i=t||"BESbswy",a=0,l=e||3e3,f=(new Date).getTime();return new Promise((function(t,e){if(p(r.context)&&!function(t){return null===u&&(p(t)&&/Apple/.test(window.navigator.vendor)?(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),u=!!t&&603>parseInt(t[1],10)):u=!1),u}(r.context)){var d=new Promise((function(t,e){!function n(){(new Date).getTime()-f>=l?e(Error(l+"ms timeout exceeded")):r.context.document.fonts.load(h(r,'"'+r.family+'"'),i).then((function(e){1<=e.length?t():setTimeout(n,25)}),e)}()})),v=new Promise((function(t,e){a=setTimeout((function(){e(Error(l+"ms timeout exceeded"))}),l)}));Promise.race([v,d]).then((function(){clearTimeout(a),t(r)}),e)}else!function(t){document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",(function e(){document.removeEventListener("DOMContentLoaded",e),t()})):document.attachEvent("onreadystatechange",(function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),t())}))}((function(){function u(){var e;(e=-1!=y&&-1!=m||-1!=y&&-1!=g||-1!=m&&-1!=g)&&((e=y!=m&&y!=g&&m!=g)||(null===c&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),c=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))),e=c&&(y==w&&m==w&&g==w||y==_&&m==_&&g==_||y==x&&m==x&&g==x)),e=!e),e&&(null!==b.parentNode&&b.parentNode.removeChild(b),clearTimeout(a),t(r))}var p=new n(i),d=new n(i),v=new n(i),y=-1,m=-1,g=-1,w=-1,_=-1,x=-1,b=document.createElement("div");b.dir="ltr",o(p,h(r,"sans-serif")),o(d,h(r,"serif")),o(v,h(r,"monospace")),b.appendChild(p.g),b.appendChild(d.g),b.appendChild(v.g),r.context.document.body.appendChild(b),w=p.g.offsetWidth,_=d.g.offsetWidth,x=v.g.offsetWidth,function t(){if((new Date).getTime()-f>=l)null!==b.parentNode&&b.parentNode.removeChild(b),e(Error(l+"ms timeout exceeded"));else{var n=r.context.document.hidden;!0!==n&&void 0!==n||(y=p.g.offsetWidth,m=d.g.offsetWidth,g=v.g.offsetWidth,u()),a=setTimeout(t,50)}}(),s(p,(function(t){y=t,u()})),o(p,h(r,'"'+r.family+'",sans-serif')),s(d,(function(t){m=t,u()})),o(d,h(r,'"'+r.family+'",serif')),s(v,(function(t){g=t,u()})),o(v,h(r,'"'+r.family+'",monospace'))}))}))},"object"===r(t)?t.exports=a:(window.FontFaceObserver=a,window.FontFaceObserver.prototype.load=a.prototype.load)}()},333:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onResult,r=t.onDone,o="";return o+="var _results = new Array(".concat(this.options.taps.length,");\n"),o+="var _checkDone = function() {\n",o+="for(var i = 0; i < _results.length; i++) {\n",o+="var item = _results[i];\n",o+="if(item === undefined) return false;\n",o+="if(item.result !== undefined) {\n",o+=n("item.result"),o+="return true;\n",o+="}\n",o+="if(item.error) {\n",o+=e("item.error"),o+="return true;\n",o+="}\n",o+="}\n",o+="return false;\n",o+="}\n",o+=this.callTapsParallel({onError:function(t,e,n,r){var o="";return o+="if(".concat(t," < _results.length && ((_results.length = ").concat(t+1,"), (_results[").concat(t,"] = { error: ").concat(e," }), _checkDone())) {\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n"},onResult:function(t,e,n,r){var o="";return o+="if(".concat(t," < _results.length && (").concat(e," !== undefined && (_results.length = ").concat(t+1,"), (_results[").concat(t,"] = { result: ").concat(e," }), _checkDone())) {\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n"},onTap:function(t,e,n,r){var o="";return t>0&&(o+="if(".concat(t," >= _results.length) {\n"),o+=n(),o+="} else {\n"),o+=e(),t>0&&(o+="}\n"),o},onDone:r})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},276:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onDone;return this.callTapsParallel({onError:function(t,n,r,o){return e(n)+o(!0)},onDone:n})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},675:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onResult,r=t.resultReturns,o=t.onDone;return this.callTapsSeries({onError:function(t,n,r,o){return e(n)+o(!0)},onResult:function(t,e,r){return"if(".concat(e," !== undefined) {\n").concat(n(e),"\n} else {\n").concat(r(),"}\n")},resultReturns:r,onDone:o})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},274:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onDone;return this.callTapsSeries({onError:function(t,n,r,o){return e(n)+o(!0)},onDone:n})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},711:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onDone;return this.callTapsLooping({onError:function(t,n,r,o){return e(n)+o(!0)},onDone:n})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},227:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=this,n=t.onError,r=t.onResult;t.onDone;return this.callTapsSeries({onError:function(t,e,r,o){return n(e)+o(!0)},onResult:function(t,n,r){var o="";return o+="if(".concat(n," !== undefined) {\n"),o+="".concat(e._args[0]," = ").concat(n,";\n"),o+="}\n",o+=r()},onDone:function(){return r(e._args[0])}})}}]),n}(n(715)),u=new c,l=function(t){return u.setup(this,t),u.create(t)};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");var n=new a(t,e);return n.constructor=f,n.compile=l,n._call=void 0,n.call=void 0,n}f.prototype=null,t.exports=f},925:function(t,e,n){"use strict";var r=n(390).default,o=n(334).default,i=n(895).default,s=n(616).default,a=n(603).deprecate((function(){}),"Hook.context is deprecated and will be removed"),c=function(){return this.call=this._createCall("sync"),this.call.apply(this,arguments)},u=function(){return this.callAsync=this._createCall("async"),this.callAsync.apply(this,arguments)},l=function(){return this.promise=this._createCall("promise"),this.promise.apply(this,arguments)},f=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;i(this,t),this._args=e,this.name=n,this.taps=[],this.interceptors=[],this._call=c,this.call=c,this._callAsync=u,this.callAsync=u,this._promise=l,this.promise=l,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}return s(t,[{key:"compile",value:function(t){throw new Error("Abstract: should be overridden")}},{key:"_createCall",value:function(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})}},{key:"_tap",value:function(t,e,n){if("string"==typeof e)e={name:e.trim()};else if("object"!==o(e)||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");void 0!==e.context&&a(),e=Object.assign({type:t,fn:n},e),e=this._runRegisterInterceptors(e),this._insert(e)}},{key:"tap",value:function(t,e){this._tap("sync",t,e)}},{key:"tapAsync",value:function(t,e){this._tap("async",t,e)}},{key:"tapPromise",value:function(t,e){this._tap("promise",t,e)}},{key:"_runRegisterInterceptors",value:function(t){var e,n=r(this.interceptors);try{for(n.s();!(e=n.n()).done;){var o=e.value;if(o.register){var i=o.register(t);void 0!==i&&(t=i)}}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"withOptions",value:function(t){var e=this,n=function(e){return Object.assign({},t,"string"==typeof e?{name:e}:e)};return{name:this.name,tap:function(t,r){return e.tap(n(t),r)},tapAsync:function(t,r){return e.tapAsync(n(t),r)},tapPromise:function(t,r){return e.tapPromise(n(t),r)},intercept:function(t){return e.intercept(t)},isUsed:function(){return e.isUsed()},withOptions:function(t){return e.withOptions(n(t))}}}},{key:"isUsed",value:function(){return this.taps.length>0||this.interceptors.length>0}},{key:"intercept",value:function(t){if(this._resetCompilation(),this.interceptors.push(Object.assign({},t)),t.register)for(var e=0;e<this.taps.length;e++)this.taps[e]=t.register(this.taps[e])}},{key:"_resetCompilation",value:function(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}},{key:"_insert",value:function(t){var e;this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));var n=0;"number"==typeof t.stage&&(n=t.stage);for(var r=this.taps.length;r>0;){r--;var o=this.taps[r];this.taps[r+1]=o;var i=o.stage||0;if(e){if(e.has(o.name)){e.delete(o.name);continue}if(e.size>0)continue}if(!(i>n)){r++;break}}this.taps[r]=t}}]),t}();Object.setPrototypeOf(f.prototype,null),t.exports=f},715:function(t,e,n){"use strict";var r=n(390).default,o=n(895).default,i=n(616).default,s=function(){function t(e){o(this,t),this.config=e,this.options=void 0,this._args=void 0}return i(t,[{key:"create",value:function(t){var e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"throw ".concat(t,";\n")},onResult:function(t){return"return ".concat(t,";\n")},resultReturns:!0,onDone:function(){return""},rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:function(t){return"_callback(".concat(t,");\n")},onResult:function(t){return"_callback(null, ".concat(t,");\n")},onDone:function(){return"_callback();\n"}}));break;case"promise":var n=!1,r=this.contentWithInterceptors({onError:function(t){return n=!0,"_error(".concat(t,");\n")},onResult:function(t){return"_resolve(".concat(t,");\n")},onDone:function(){return"_resolve();\n"}}),o="";o+='"use strict";\n',o+=this.header(),o+="return new Promise((function(_resolve, _reject) {\n",n&&(o+="var _sync = true;\n",o+="function _error(_err) {\n",o+="if(_sync)\n",o+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",o+="else\n",o+="_reject(_err);\n",o+="};\n"),o+=r,n&&(o+="_sync = false;\n"),o+="}));\n",e=new Function(this.args(),o)}return this.deinit(),e}},{key:"setup",value:function(t,e){t._x=e.taps.map((function(t){return t.fn}))}},{key:"init",value:function(t){this.options=t,this._args=t.args.slice()}},{key:"deinit",value:function(){this.options=void 0,this._args=void 0}},{key:"contentWithInterceptors",value:function(t){var e=this;if(this.options.interceptors.length>0){for(var n=t.onError,r=t.onResult,o=t.onDone,i="",s=0;s<this.options.interceptors.length;s++){var a=this.options.interceptors[s];a.call&&(i+="".concat(this.getInterceptor(s),".call(").concat(this.args({before:a.context?"_context":void 0}),");\n"))}return i+=this.content(Object.assign(t,{onError:n&&function(t){for(var r="",o=0;o<e.options.interceptors.length;o++){e.options.interceptors[o].error&&(r+="".concat(e.getInterceptor(o),".error(").concat(t,");\n"))}return r+=n(t)},onResult:r&&function(t){for(var n="",o=0;o<e.options.interceptors.length;o++){e.options.interceptors[o].result&&(n+="".concat(e.getInterceptor(o),".result(").concat(t,");\n"))}return n+=r(t)},onDone:o&&function(){for(var t="",n=0;n<e.options.interceptors.length;n++){e.options.interceptors[n].done&&(t+="".concat(e.getInterceptor(n),".done();\n"))}return t+=o()}}))}return this.content(t)}},{key:"header",value:function(){var t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",this.options.interceptors.length>0&&(t+="var _taps = this.taps;\n",t+="var _interceptors = this.interceptors;\n"),t}},{key:"needContext",value:function(){var t,e=r(this.options.taps);try{for(e.s();!(t=e.n()).done;){if(t.value.context)return!0}}catch(t){e.e(t)}finally{e.f()}return!1}},{key:"callTap",value:function(t,e){for(var n=e.onError,r=e.onResult,o=e.onDone,i=e.rethrowIfPossible,s="",a=!1,c=0;c<this.options.interceptors.length;c++){var u=this.options.interceptors[c];u.tap&&(a||(s+="var _tap".concat(t," = ").concat(this.getTap(t),";\n"),a=!0),s+="".concat(this.getInterceptor(c),".tap(").concat(u.context?"_context, ":"","_tap").concat(t,");\n"))}s+="var _fn".concat(t," = ").concat(this.getTapFn(t),";\n");var l=this.options.taps[t];switch(l.type){case"sync":i||(s+="var _hasError".concat(t," = false;\n"),s+="try {\n"),s+=r?"var _result".concat(t," = _fn").concat(t,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"):"_fn".concat(t,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"),i||(s+="} catch(_err) {\n",s+="_hasError".concat(t," = true;\n"),s+=n("_err"),s+="}\n",s+="if(!_hasError".concat(t,") {\n")),r&&(s+=r("_result".concat(t))),o&&(s+=o()),i||(s+="}\n");break;case"async":var f="";f+=r?"(function(_err".concat(t,", _result").concat(t,") {\n"):"(function(_err".concat(t,") {\n"),f+="if(_err".concat(t,") {\n"),f+=n("_err".concat(t)),f+="} else {\n",r&&(f+=r("_result".concat(t))),o&&(f+=o()),f+="}\n",f+="})",s+="_fn".concat(t,"(").concat(this.args({before:l.context?"_context":void 0,after:f}),");\n");break;case"promise":s+="var _hasResult".concat(t," = false;\n"),s+="var _promise".concat(t," = _fn").concat(t,"(").concat(this.args({before:l.context?"_context":void 0}),");\n"),s+="if (!_promise".concat(t," || !_promise").concat(t,".then)\n"),s+="  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise".concat(t," + ')');\n"),s+="_promise".concat(t,".then((function(_result").concat(t,") {\n"),s+="_hasResult".concat(t," = true;\n"),r&&(s+=r("_result".concat(t))),o&&(s+=o()),s+="}), function(_err".concat(t,") {\n"),s+="if(_hasResult".concat(t,") throw _err").concat(t,";\n"),s+=n("_err".concat(t)),s+="});\n"}return s}},{key:"callTapsSeries",value:function(t){var e=this,n=t.onError,r=t.onResult,o=t.resultReturns,i=t.onDone,s=t.doneReturns,a=t.rethrowIfPossible;if(0===this.options.taps.length)return i();for(var c=this.options.taps.findIndex((function(t){return"sync"!==t.type})),u=o||s,l="",f=i,p=0,h=function(){var t=d;f!==i&&("sync"!==e.options.taps[t].type||p++>20)&&(p=0,l+="function _next".concat(t,"() {\n"),l+=f(),l+="}\n",f=function(){return"".concat(u?"return ":"","_next").concat(t,"();\n")});var o=f,s=function(t){return t?"":i()},h=e.callTap(t,{onError:function(e){return n(t,e,o,s)},onResult:r&&function(e){return r(t,e,o,s)},onDone:!r&&o,rethrowIfPossible:a&&(c<0||t<c)});f=function(){return h}},d=this.options.taps.length-1;d>=0;d--)h();return l+=f()}},{key:"callTapsLooping",value:function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;if(0===this.options.taps.length)return n();var o=this.options.taps.every((function(t){return"sync"===t.type})),i="";o||(i+="var _looper = (function() {\n",i+="var _loopAsync = false;\n"),i+="var _loop;\n",i+="do {\n",i+="_loop = false;\n";for(var s=0;s<this.options.interceptors.length;s++){var a=this.options.interceptors[s];a.loop&&(i+="".concat(this.getInterceptor(s),".loop(").concat(this.args({before:a.context?"_context":void 0}),");\n"))}return i+=this.callTapsSeries({onError:e,onResult:function(t,e,n,r){var i="";return i+="if(".concat(e," !== undefined) {\n"),i+="_loop = true;\n",o||(i+="if(_loopAsync) _looper();\n"),i+=r(!0),i+="} else {\n",i+=n(),i+="}\n"},onDone:n&&function(){var t="";return t+="if(!_loop) {\n",t+=n(),t+="}\n"},rethrowIfPossible:r&&o}),i+="} while(_loop);\n",o||(i+="_loopAsync = true;\n",i+="});\n",i+="_looper();\n"),i}},{key:"callTapsParallel",value:function(t){var e=this,n=t.onError,r=t.onResult,o=t.onDone,i=t.rethrowIfPossible,s=t.onTap,a=void 0===s?function(t,e){return e()}:s;if(this.options.taps.length<=1)return this.callTapsSeries({onError:n,onResult:r,onDone:o,rethrowIfPossible:i});var c="";c+="do {\n",c+="var _counter = ".concat(this.options.taps.length,";\n"),o&&(c+="var _done = (function() {\n",c+=o(),c+="});\n");for(var u=function(t){var s=function(){return o?"if(--_counter === 0) _done();\n":"--_counter;"},u=function(t){return t||!o?"_counter = 0;\n":"_counter = 0;\n_done();\n"};c+="if(_counter <= 0) break;\n",c+=a(t,(function(){return e.callTap(t,{onError:function(e){var r="";return r+="if(_counter > 0) {\n",r+=n(t,e,s,u),r+="}\n"},onResult:r&&function(e){var n="";return n+="if(_counter > 0) {\n",n+=r(t,e,s,u),n+="}\n"},onDone:!r&&function(){return s()},rethrowIfPossible:i})}),s,u)},l=0;l<this.options.taps.length;l++)u(l);return c+="} while(false);\n"}},{key:"args",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.before,n=t.after,r=this._args;return e&&(r=[e].concat(r)),n&&(r=r.concat(n)),0===r.length?"":r.join(", ")}},{key:"getTapFn",value:function(t){return"_x[".concat(t,"]")}},{key:"getTap",value:function(t){return"_taps[".concat(t,"]")}},{key:"getInterceptor",value:function(t){return"_interceptors[".concat(t,"]")}}]),t}();t.exports=s},240:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(603),s=function(t,e){return e},a=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;r(this,t),this._map=new Map,this.name=n,this._factory=e,this._interceptors=[]}return o(t,[{key:"get",value:function(t){return this._map.get(t)}},{key:"for",value:function(t){var e=this.get(t);if(void 0!==e)return e;for(var n=this._factory(t),r=this._interceptors,o=0;o<r.length;o++)n=r[o].factory(t,n);return this._map.set(t,n),n}},{key:"intercept",value:function(t){this._interceptors.push(Object.assign({factory:s},t))}}]),t}();a.prototype.tap=i.deprecate((function(t,e,n){return this.for(t).tap(e,n)}),"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead."),a.prototype.tapAsync=i.deprecate((function(t,e,n){return this.for(t).tapAsync(e,n)}),"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead."),a.prototype.tapPromise=i.deprecate((function(t,e,n){return this.for(t).tapPromise(e,n)}),"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead."),t.exports=a},756:function(t,e,n){"use strict";var r=n(390).default,o=n(895).default,i=n(616).default,s=(n(925),function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;o(this,t),this.hooks=e,this.name=n}return i(t,[{key:"tap",value:function(t,e){var n,o=r(this.hooks);try{for(o.s();!(n=o.n()).done;){n.value.tap(t,e)}}catch(t){o.e(t)}finally{o.f()}}},{key:"tapAsync",value:function(t,e){var n,o=r(this.hooks);try{for(o.s();!(n=o.n()).done;){n.value.tapAsync(t,e)}}catch(t){o.e(t)}finally{o.f()}}},{key:"tapPromise",value:function(t,e){var n,o=r(this.hooks);try{for(o.s();!(n=o.n()).done;){n.value.tapPromise(t,e)}}catch(t){o.e(t)}finally{o.f()}}},{key:"isUsed",value:function(){var t,e=r(this.hooks);try{for(e.s();!(t=e.n()).done;){if(t.value.isUsed())return!0}}catch(t){e.e(t)}finally{e.f()}return!1}},{key:"intercept",value:function(t){var e,n=r(this.hooks);try{for(n.s();!(e=n.n()).done;){e.value.intercept(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"withOptions",value:function(e){return new t(this.hooks.map((function(t){return t.withOptions(e)})),this.name)}}]),t}());t.exports=s},461:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onResult,r=t.resultReturns,o=t.onDone,i=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,n){return e(n)},onResult:function(t,e,r){return"if(".concat(e," !== undefined) {\n").concat(n(e),";\n} else {\n").concat(r(),"}\n")},resultReturns:r,onDone:o,rethrowIfPossible:i})}}]),n}(n(715)),u=new c,l=function(){throw new Error("tapAsync is not supported on a SyncBailHook")},f=function(){throw new Error("tapPromise is not supported on a SyncBailHook")},p=function(t){return u.setup(this,t),u.create(t)};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=h,n.tapAsync=l,n.tapPromise=f,n.compile=p,n}h.prototype=null,t.exports=h},755:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,n){return e(n)},onDone:n,rethrowIfPossible:r})}}]),n}(n(715)),u=new c,l=function(){throw new Error("tapAsync is not supported on a SyncHook")},f=function(){throw new Error("tapPromise is not supported on a SyncHook")},p=function(t){return u.setup(this,t),u.create(t)};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=h,n.tapAsync=l,n.tapPromise=f,n.compile=p,n}h.prototype=null,t.exports=h},328:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=t.onError,n=t.onDone,r=t.rethrowIfPossible;return this.callTapsLooping({onError:function(t,n){return e(n)},onDone:n,rethrowIfPossible:r})}}]),n}(n(715)),u=new c,l=function(){throw new Error("tapAsync is not supported on a SyncLoopHook")},f=function(){throw new Error("tapPromise is not supported on a SyncLoopHook")},p=function(t){return u.setup(this,t),u.create(t)};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=new a(t,e);return n.constructor=h,n.tapAsync=l,n.tapPromise=f,n.compile=p,n}h.prototype=null,t.exports=h},842:function(t,e,n){"use strict";var r=n(895).default,o=n(616).default,i=n(378).default,s=n(589).default,a=n(925),c=function(t){i(n,t);var e=s(n);function n(){return r(this,n),e.apply(this,arguments)}return o(n,[{key:"content",value:function(t){var e=this,n=t.onError,r=t.onResult,o=t.resultReturns,i=t.rethrowIfPossible;return this.callTapsSeries({onError:function(t,e){return n(e)},onResult:function(t,n,r){var o="";return o+="if(".concat(n," !== undefined) {\n"),o+="".concat(e._args[0]," = ").concat(n,";\n"),o+="}\n",o+=r()},onDone:function(){return r(e._args[0])},doneReturns:o,rethrowIfPossible:i})}}]),n}(n(715)),u=new c,l=function(){throw new Error("tapAsync is not supported on a SyncWaterfallHook")},f=function(){throw new Error("tapPromise is not supported on a SyncWaterfallHook")},p=function(t){return u.setup(this,t),u.create(t)};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");var n=new a(t,e);return n.constructor=h,n.tapAsync=l,n.tapPromise=f,n.compile=p,n}h.prototype=null,t.exports=h},966:function(t,e,n){"use strict";n(755),n(461),n(842),n(328),n(276),n(333),e.AsyncSeriesHook=n(274),n(675),n(711),n(227),n(240),n(756)},603:function(t,e){"use strict";e.deprecate=function(t,e){var n=!0;return function(){return n&&(console.warn("DeprecationWarning: "+e),n=!1),t.apply(this,arguments)}}},607:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},447:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},814:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},490:function(t){function e(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}t.exports=function(t){return function(){var n=this,r=arguments;return new Promise((function(o,i){var s=t.apply(n,r);function a(t){e(s,o,i,a,c,"next",t)}function c(t){e(s,o,i,a,c,"throw",t)}a(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports},895:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},616:function(t,e,n){var r=n(444);function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}t.exports=function(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},390:function(t,e,n){var r=n(894);t.exports=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,s=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}},t.exports.__esModule=!0,t.exports.default=t.exports},589:function(t,e,n){var r=n(674),o=n(126),i=n(167);t.exports=function(t){var e=o();return function(){var n,o=r(t);if(e){var s=r(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return i(this,n)}},t.exports.__esModule=!0,t.exports.default=t.exports},818:function(t,e,n){var r=n(444);t.exports=function(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},674:function(t){function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},378:function(t,e,n){var r=n(23);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},126:function(t){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},660:function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,s,a=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports},735:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},379:function(t,e,n){var r=n(818);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t},t.exports.__esModule=!0,t.exports.default=t.exports},167:function(t,e,n){var r=n(334).default,o=n(814);t.exports=function(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)},t.exports.__esModule=!0,t.exports.default=t.exports},180:function(t,e,n){var r=n(334).default;function o(){"use strict";t.exports=o=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,i=Object.create(o.prototype),a=new S(r||[]);return s(i,"_invoke",{value:E(t,n,a)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d={};function v(){}function y(){}function m(){}var g={};f(g,c,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(A([])));_&&_!==n&&i.call(_,c)&&(g=_);var x=m.prototype=v.prototype=Object.create(g);function b(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,s,a,c){var u=h(t[o],t,s);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==r(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var o;s(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}})}function E(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=O(s,n);if(a){if(a===d)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=h(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function O(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=h(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:j}}function j(){return{value:void 0,done:!0}}return y.prototype=m,s(x,"constructor",{value:m,configurable:!0}),s(m,"constructor",{value:y,configurable:!0}),y.displayName=f(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,f(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},b(k.prototype),f(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new k(p(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},b(x),f(x,l,"Generator"),f(x,c,(function(){return this})),f(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;P(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:A(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},23:function(t){function e(n,r){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},152:function(t,e,n){var r=n(447),o=n(660),i=n(894),s=n(735);t.exports=function(t,e){return r(t)||o(t,e)||i(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},752:function(t,e,n){var r=n(334).default;t.exports=function(t,e){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)},t.exports.__esModule=!0,t.exports.default=t.exports},444:function(t,e,n){var r=n(334).default,o=n(752);t.exports=function(t){var e=o(t,"string");return"symbol"===r(e)?e:String(e)},t.exports.__esModule=!0,t.exports.default=t.exports},334:function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},894:function(t,e,n){var r=n(607);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r](i,i.exports,n),i.loaded=!0,i.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var r={};return function(){"use strict";n.r(r),n.d(r,{default:function(){return yt}});var t=n(895),e=n.n(t),o=n(616),i=n.n(o),s=n(814),a=n.n(s),c=n(378),u=n.n(c),l=n(589),f=n.n(l),p=n(818),h=n.n(p),d=n(843),v=n.n(d),y=n(334),m=n.n(y),g="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function w(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on".concat(e),(function(){n(window.event)}))}function _(t,e){for(var n=e.slice(0,e.length-1),r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function x(t){"string"!=typeof t&&(t="");for(var e=(t=t.replace(/\s/g,"")).split(","),n=e.lastIndexOf("");n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}for(var b={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":g?173:189,"=":g?61:187,";":g?59:186,"'":222,"[":219,"]":221,"\\":220},k={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},E={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},O={16:!1,18:!1,17:!1,91:!1},L={},P=1;P<20;P++)b["f".concat(P)]=111+P;var S=[],A=!1,j="all",M=[],C=function(t){return b[t.toLowerCase()]||k[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function T(t){j=t||"all"}function R(){return j||"all"}var I=function(t){var e=t.key,n=t.scope,r=t.method,o=t.splitKey,i=void 0===o?"+":o;x(e).forEach((function(t){var e=t.split(i),o=e.length,s=e[o-1],a="*"===s?"*":C(s);if(L[a]){n||(n=R());var c=o>1?_(k,e):[];L[a]=L[a].filter((function(t){return!((!r||t.method===r)&&t.scope===n&&function(t,e){for(var n=t.length>=e.length?t:e,r=t.length>=e.length?e:t,o=!0,i=0;i<n.length;i++)-1===r.indexOf(n[i])&&(o=!1);return o}(t.mods,c))}))}}))};function D(t,e,n,r){var o;if(e.element===r&&(e.scope===n||"all"===e.scope)){for(var i in o=e.mods.length>0,O)Object.prototype.hasOwnProperty.call(O,i)&&(!O[i]&&e.mods.indexOf(+i)>-1||O[i]&&-1===e.mods.indexOf(+i))&&(o=!1);(0!==e.mods.length||O[16]||O[18]||O[17]||O[91])&&!o&&"*"!==e.shortcut||(e.keys=[],e.keys=e.keys.concat(S),!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function N(t,e){var n=L["*"],r=t.keyCode||t.which||t.charCode;if(K.filter.call(this,t)){if(93!==r&&224!==r||(r=91),-1===S.indexOf(r)&&229!==r&&S.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(e){var n=E[e];t[e]&&-1===S.indexOf(n)?S.push(n):!t[e]&&S.indexOf(n)>-1?S.splice(S.indexOf(n),1):"metaKey"===e&&t[e]&&3===S.length&&(t.ctrlKey||t.shiftKey||t.altKey||(S=S.slice(S.indexOf(n))))})),r in O){for(var o in O[r]=!0,k)k[o]===r&&(K[o]=!0);if(!n)return}for(var i in O)Object.prototype.hasOwnProperty.call(O,i)&&(O[i]=t[E[i]]);t.getModifierState&&(!t.altKey||t.ctrlKey)&&t.getModifierState("AltGraph")&&(-1===S.indexOf(17)&&S.push(17),-1===S.indexOf(18)&&S.push(18),O[17]=!0,O[18]=!0);var s=R();if(n)for(var a=0;a<n.length;a++)n[a].scope===s&&("keydown"===t.type&&n[a].keydown||"keyup"===t.type&&n[a].keyup)&&D(t,n[a],s,e);if(r in L)for(var c=0;c<L[r].length;c++)if(("keydown"===t.type&&L[r][c].keydown||"keyup"===t.type&&L[r][c].keyup)&&L[r][c].key){for(var u=L[r][c],l=u.splitKey,f=u.key.split(l),p=[],h=0;h<f.length;h++)p.push(C(f[h]));p.sort().join("")===S.sort().join("")&&D(t,u,s,e)}}}function K(t,e,n){S=[];var r=x(t),o=[],i="all",s=document,a=0,c=!1,u=!0,l="+",f=!1;for(void 0===n&&"function"==typeof e&&(n=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(i=e.scope),e.element&&(s=e.element),e.keyup&&(c=e.keyup),void 0!==e.keydown&&(u=e.keydown),void 0!==e.capture&&(f=e.capture),"string"==typeof e.splitKey&&(l=e.splitKey)),"string"==typeof e&&(i=e);a<r.length;a++)o=[],(t=r[a].split(l)).length>1&&(o=_(k,t)),(t="*"===(t=t[t.length-1])?"*":C(t))in L||(L[t]=[]),L[t].push({keyup:c,keydown:u,scope:i,mods:o,shortcut:r[a],method:n,key:r[a],splitKey:l,element:s});void 0!==s&&!function(t){return M.indexOf(t)>-1}(s)&&window&&(M.push(s),w(s,"keydown",(function(t){N(t,s)}),f),A||(A=!0,w(window,"focus",(function(){S=[]}),f)),w(s,"keyup",(function(t){N(t,s),function(t){var e=t.keyCode||t.which||t.charCode,n=S.indexOf(e);if(n>=0&&S.splice(n,1),t.key&&"meta"===t.key.toLowerCase()&&S.splice(0,S.length),93!==e&&224!==e||(e=91),e in O)for(var r in O[e]=!1,k)k[r]===e&&(K[r]=!1)}(t)}),f))}var F={getPressedKeyString:function(){return S.map((function(t){return e=t,Object.keys(b).find((function(t){return b[t]===e}))||function(t){return Object.keys(k).find((function(e){return k[e]===t}))}(t)||String.fromCharCode(t);var e}))},setScope:T,getScope:R,deleteScope:function(t,e){var n,r;for(var o in t||(t=R()),L)if(Object.prototype.hasOwnProperty.call(L,o))for(n=L[o],r=0;r<n.length;)n[r].scope===t?n.splice(r,1):r++;R()===t&&T(e||"all")},getPressedKeyCodes:function(){return S.slice(0)},getAllKeyCodes:function(){var t=[];return Object.keys(L).forEach((function(e){L[e].forEach((function(e){var n=e.key,r=e.scope,o=e.mods,i=e.shortcut;t.push({scope:r,shortcut:i,mods:o,keys:n.split("+").map((function(t){return C(t)}))})}))})),t},isPressed:function(t){return"string"==typeof t&&(t=C(t)),-1!==S.indexOf(t)},filter:function(t){var e=t.target||t.srcElement,n=e.tagName,r=!0;return!e.isContentEditable&&("INPUT"!==n&&"TEXTAREA"!==n&&"SELECT"!==n||e.readOnly)||(r=!1),r},trigger:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(L).forEach((function(n){L[n].filter((function(n){return n.scope===e&&n.shortcut===t})).forEach((function(t){t&&t.method&&t.method()}))}))},unbind:function(t){if(void 0===t)Object.keys(L).forEach((function(t){return delete L[t]}));else if(Array.isArray(t))t.forEach((function(t){t.key&&I(t)}));else if("object"===m()(t))t.key&&I(t);else if("string"==typeof t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=n[0],i=n[1];"function"==typeof o&&(i=o,o=""),I({key:t,scope:o,method:i,splitKey:"+"})}},keyMap:b,modifier:k,modifierMap:E};for(var H in F)Object.prototype.hasOwnProperty.call(F,H)&&(K[H]=F[H]);if("undefined"!=typeof window){var W=window.hotkeys;K.noConflict=function(t){return t&&window.hotkeys===K&&(window.hotkeys=W),K},window.hotkeys=K}var U,B=n(390),G=n.n(B),J=function(){function t(n,r){var o=this;e()(this,t),h()(this,"container",void 0),h()(this,"dom",void 0),h()(this,"shown",void 0),h()(this,"root",void 0),h()(this,"parent",void 0),h()(this,"submenus",void 0),h()(this,"items",void 0),h()(this,"_onclick",void 0),h()(this,"_oncontextmenu",void 0),h()(this,"_oncontextmenu_keydown",void 0),h()(this,"_onblur",void 0),this.container=n,this.dom=null,this.shown=!1,this.root=!0,this.parent=null,this.submenus=[],this.items=r,this._onclick=function(t){!(o.dom&&t.target instanceof HTMLElement&&t.target!=o.dom&&t.target.parentElement!=o.dom)||t.target.classList.contains("item")||t.target.parentElement instanceof HTMLElement&&t.target.parentElement.classList.contains("item")||o.hideAll()},this._oncontextmenu=function(t){if(t.preventDefault(),!(!(t.target!=o.dom&&t.target instanceof HTMLElement)||t.target.parentElement&&t.target.parentElement==o.dom||t.target.classList.contains("item")||t.target.parentElement&&t.target.parentElement.classList.contains("item"))){var e=t;o.hideAll(),o.show(e.clientX,e.clientY)}},this._oncontextmenu_keydown=function(t){93==t.keyCode&&(t.preventDefault(),o.hideAll(),o.show(0,0))},this._onblur=function(){o.hideAll()}}return i()(t,[{key:"getMenuDom",value:function(){var t=document.createElement("div");t.classList.add("context");var e,n=G()(this.items);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.appendChild(this.itemToDomEl(r))}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"itemToDomEl",value:function(e){var n=this,r=document.createElement("div");if(null===e)return r.className="separator",r;e.hasOwnProperty("color")&&/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.color.toString())&&(r.style.cssText="color: ".concat(e.color)),r.classList.add("item");var o=document.createElement("span");o.className="label",o.innerText=e.hasOwnProperty("text")?e.text.toString():"",r.appendChild(o),e.hasOwnProperty("disabled")&&e.disabled?r.classList.add("disabled"):r.classList.add("enabled");var i=document.createElement("span");if(i.className="hotkey",i.innerText=e.hasOwnProperty("hotkey")?e.hotkey.toString():"",r.appendChild(i),e.hasOwnProperty("subitems")&&Array.isArray(e.subitems)&&e.subitems.length>0){var s=new t(this.container,e.subitems);s.root=!1,s.parent=this;var a=function(){if(!e.hasOwnProperty("disabled")||1!=e.disabled){n.hideSubMenus();var t=n.dom.offsetLeft+n.dom.clientWidth+r.offsetLeft,o=n.dom.offsetTop+r.offsetTop;s.shown?s.hide():s.show(t,o)}};this.submenus.push(s),r.classList.add("has-subitems"),r.addEventListener("click",a),r.addEventListener("mousemove",a)}else if(e.hasOwnProperty("submenu")&&e.submenu instanceof t){var c=e.submenu;c.root=!1,c.parent=this;var u=function(){if(!e.hasOwnProperty("disabled")||1!=e.disabled){n.hideSubMenus();var t=n.dom.offsetLeft+n.dom.clientWidth+r.offsetLeft,o=n.dom.offsetTop+r.offsetTop;c.shown?c.hide():c.show(t,o)}};this.submenus.push(c),r.classList.add("has-subitems"),r.addEventListener("click",u),r.addEventListener("mousemove",u)}else r.addEventListener("click",(function(){if(n.hideSubMenus(),!r.classList.contains("disabled"))if(e.hasOwnProperty("onclick")&&"function"==typeof e.onclick){var t={handled:!1,item:r,label:o,hotkey:i,items:n.items,data:e};e.onclick(t),t.handled||n.hide()}else n.hide()})),r.addEventListener("mousemove",(function(){n.hideSubMenus()}));return r}},{key:"hideAll",value:function(){!this.root||this.parent?this.parent.hide():this.shown&&(this.hideSubMenus(),this.shown=!1,this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide())}},{key:"hide",value:function(){this.dom&&this.shown&&(this.shown=!1,this.hideSubMenus(),this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide())}},{key:"hideSubMenus",value:function(){var t,e=G()(this.submenus);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.shown&&(n.shown=!1,n.container.removeChild(n.dom)),n.hideSubMenus()}}catch(t){e.e(t)}finally{e.f()}}},{key:"show",value:function(t,e){this.dom=this.getMenuDom(),this.dom.style.left="".concat(t,"px"),this.dom.style.top="".concat(e,"px"),this.shown=!0,this.container.appendChild(this.dom)}},{key:"install",value:function(){this.container.addEventListener("contextmenu",this._oncontextmenu),this.container.addEventListener("keydown",this._oncontextmenu_keydown),this.container.addEventListener("click",this._onclick),window.addEventListener("blur",this._onblur)}},{key:"setData",value:function(t){this.items=t}},{key:"uninstall",value:function(){this.dom=null,this.container.removeEventListener("keydown",this._oncontextmenu_keydown),this.container.removeEventListener("click",this._onclick),window.removeEventListener("blur",this._onblur)}}]),t}(),V=n(152),z=n.n(V),Y=new Uint8Array(16);function X(){if(!U&&!(U="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(Y)}var $=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var q=function(t){return"string"==typeof t&&$.test(t)},Q=[],Z=0;Z<256;++Z)Q.push((Z+256).toString(16).substr(1));var tt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Q[t[e+0]]+Q[t[e+1]]+Q[t[e+2]]+Q[t[e+3]]+"-"+Q[t[e+4]]+Q[t[e+5]]+"-"+Q[t[e+6]]+Q[t[e+7]]+"-"+Q[t[e+8]]+Q[t[e+9]]+"-"+Q[t[e+10]]+Q[t[e+11]]+Q[t[e+12]]+Q[t[e+13]]+Q[t[e+14]]+Q[t[e+15]]).toLowerCase();if(!q(n))throw TypeError("Stringified UUID is invalid");return n};var et=function(t,e,n){var r=(t=t||{}).random||(t.rng||X)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=r[o];return e}return tt(r)},nt=n(180),rt=n.n(nt),ot=n(379),it=n.n(ot),st=n(490),at=n.n(st);function ct(t){var e=function(){var e=at()(rt()().mark((function e(){return rt()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(t.source);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.error("Failed to copy text: ",e.t0),e.t0;case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return{copy:e}}n(302);function ut(t){return new Promise((function(e){var n=function(t){var e=function(){};return{open:function(){var n=document.createElement("input");n.type="file",t&&(t.accept&&(n.accept=t.accept),t.capture&&(n.capture=t.capture),t.multiple&&(n.multiple=t.multiple)),n.onchange=function(){e(n.files)},n.click()},onChange:function(t){e=t}}}(t),r=n.onChange,o=n.open;r((function(t){e(t)})),o()}))}var lt=function(){var t=at()(rt()().mark((function t(e,n){return rt()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ct(it()({source:e},n)).copy();case 3:t.next=8;break;case 5:throw t.prev=5,t.t0=t.catch(0),t.t0;case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e,n){return t.apply(this,arguments)}}();function ft(t,e){var n=document.createElement("a");n.href=t,n.download="".concat(et(),".").concat(e),document.body.appendChild(n),n.click(),n.remove()}var pt=function(){function t(n,r){e()(this,t),h()(this,"canvas",void 0),h()(this,"editor",void 0),this.canvas=n,this.editor=r}return i()(t,[{key:"insert",value:function(){var t=this;ut({accept:".json"}).then((function(e){var n=z()(e,1)[0],r=new FileReader;r.readAsText(n,"UTF-8"),r.onload=function(){t.insertSvgFile(r.result)}}))}},{key:"insertSvgFile",value:function(t){var e=this;this.editor.hooksEntity.hookImportBefore.callAsync(t,(function(){console.log(t,"2222"),e.canvas.loadFromJSON(t,(function(){console.log(t,"33333"),e.canvas.renderAll(),e.editor.hooksEntity.hookImportAfter.callAsync(t,(function(){e.canvas.renderAll()}))}))}))}},{key:"getJson",value:function(){return this.canvas.toJSON(["id","gradientAngle","selectable","hasControls"])}},{key:"dragAddItem",value:function(t,e){var n=this.canvas.getSelectionElement().getBoundingClientRect(),r=n.left,o=n.top;if(!(t.x<r||t.y<o||void 0===e.width)){var i={x:t.x-r,y:t.y-o},s=this.canvas.restorePointerVpt(i);e.left=s.x-e.width/2,e.top=s.y,this.canvas.add(e),this.canvas.requestRenderAll()}}},{key:"clipboard",value:function(){var t=this.getJson();lt(JSON.stringify(t,null,"\t"))}},{key:"saveJson",value:function(){var t=this.getJson();ft("data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify(t,null,"\t"))),"json")}},{key:"saveSvg",value:function(){var t=this;this.editor.hooksEntity.hookSaveBefore.callAsync("",(function(){var e=t._getSaveSvgOption(),n=t.canvas.toSVG(e),r="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(n));t.editor.hooksEntity.hookSaveAfter.callAsync(r,(function(){ft(r,"svg")}))}))}},{key:"saveImg",value:function(){var t=this;this.editor.hooksEntity.hookSaveBefore.callAsync("",(function(){var e=t._getSaveOption();t.canvas.setViewportTransform([1,0,0,1,0,0]);var n=t.canvas.toDataURL(e);t.editor.hooksEntity.hookSaveAfter.callAsync(n,(function(){ft(n,"png")}))}))}},{key:"preview",value:function(){var t=this;return new Promise((function(e){t.editor.hooksEntity.hookSaveBefore.callAsync("",(function(){var n=t._getSaveOption();t.canvas.setViewportTransform([1,0,0,1,0,0]),t.canvas.renderAll();var r=t.canvas.toDataURL(n);t.editor.hooksEntity.hookSaveAfter.callAsync(r,(function(){e(r)}))}))}))}},{key:"_getSaveSvgOption",value:function(){var t=this.canvas.getObjects().find((function(t){return"workspace"===t.id})),e=t.left,n=t.top,r=t.width,o=t.height;return{width:r,height:o,viewBox:{x:e,y:n,width:r,height:o}}}},{key:"_getSaveOption",value:function(){var t=this.canvas.getObjects().find((function(t){return"workspace"===t.id})),e=t.left,n=t.top;return{name:"New Image",format:"png",quality:1,width:t.width,height:t.height,left:e,top:n}}},{key:"clear",value:function(){var t=this;this.canvas.getObjects().forEach((function(e){"workspace"!==e.id&&t.canvas.remove(e)})),this.canvas.discardActiveObject(),this.canvas.renderAll()}},{key:"destroy",value:function(){console.log("pluginDestroy")}}]),t}();h()(pt,"pluginName","ServersPlugin"),h()(pt,"apis",["insert","insertSvgFile","getJson","dragAddItem","clipboard","saveJson","saveSvg","saveImg","clear","preview"]);var ht=pt,dt=n(966),vt=function(t){u()(r,t);var n=f()(r);function r(t){var o;return e()(this,r),o=n.call(this),h()(a()(o),"canvas",void 0),h()(a()(o),"contextMenu",void 0),h()(a()(o),"pluginMap",{}),h()(a()(o),"customEvents",[]),h()(a()(o),"customApis",[]),h()(a()(o),"hooks",["hookImportBefore","hookImportAfter","hookSaveBefore","hookSaveAfter"]),h()(a()(o),"hooksEntity",{}),o.canvas=t,o}return i()(r,[{key:"init",value:function(t){this.canvas=t,this._initContextMenu(),this._bindContextMenu(),this._initActionHooks(),this._initServersPlugin()}},{key:"use",value:function(t,e){if(this._checkPlugin(t)){this._saveCustomAttr(t);var n=new t(this.canvas,this,e);this.pluginMap[t.pluginName]=n,this._bindingHooks(n),this._bindingHotkeys(n),this._bindingApis(n)}}},{key:"getPlugin",value:function(t){if(this.pluginMap[t])return this.pluginMap[t]}},{key:"_checkPlugin",value:function(t){var e=this,n=t.pluginName,r=t.events,o=void 0===r?[]:r,i=t.apis,s=void 0===i?[]:i;if(this.pluginMap[n])throw new Error(n+"插件重复初始化");return o.forEach((function(t){if(e.customEvents.find((function(e){return e===t})))throw new Error(n+"插件中"+t+"重复")})),s.forEach((function(t){if(e.customApis.find((function(e){return e===t})))throw new Error(n+"插件中"+t+"重复")})),!0}},{key:"_bindingHooks",value:function(t){var e=this;this.hooks.forEach((function(n){var r=t[n];r&&e.hooksEntity[n].tapPromise(t.pluginName+n,(function(){return r.apply(t,Array.prototype.slice.call(arguments))}))}))}},{key:"_bindingHotkeys",value:function(t){var e;null==t||null===(e=t.hotkeys)||void 0===e||e.forEach((function(e){K(e,{keyup:!0},(function(n){return t.hotkeyEvent(e,n)}))}))}},{key:"_saveCustomAttr",value:function(t){var e=t.events,n=void 0===e?[]:e,r=t.apis,o=void 0===r?[]:r;this.customApis=this.customApis.concat(o),this.customEvents=this.customEvents.concat(n)}},{key:"_bindingApis",value:function(t){var e=this,n=t.constructor.apis;(void 0===n?[]:n).forEach((function(n){e[n]=function(){return t[n].apply(t,Array.prototype.slice.call(arguments))}}))}},{key:"_bindContextMenu",value:function(){var t=this;this.canvas.on("mouse:down",(function(e){if(3===e.button){var n=[];Object.keys(t.pluginMap).forEach((function(e){var r=t.pluginMap[e],o=r.contextMenu&&r.contextMenu();o&&(n=n.concat(o))})),t._renderMenu(e,n)}}))}},{key:"_renderMenu",value:function(t,e){if(0!==e.length){this.contextMenu.hideAll(),this.contextMenu.setData(e);var n=t.e,r=n.clientX,o=n.clientY;this.contextMenu.show(r,o)}}},{key:"_initActionHooks",value:function(){var t=this;this.hooks.forEach((function(e){t.hooksEntity[e]=new dt.AsyncSeriesHook(["data"])}))}},{key:"_initContextMenu",value:function(){this.contextMenu=new J(this.canvas.wrapperEl,[]),this.contextMenu.install()}},{key:"_initServersPlugin",value:function(){this.use(ht,{})}}]),r}(v()),yt=vt}(),r}()}));